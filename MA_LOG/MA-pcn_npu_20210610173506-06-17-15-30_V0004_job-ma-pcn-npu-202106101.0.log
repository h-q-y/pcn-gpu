do nothing
[Modelarts Service Log]user: uid=1101(work) gid=1101(work) groups=1101(work),1000(HwHiAiUser)
[Modelarts Service Log]pwd: /home/work
[Modelarts Service Log]app_url: s3://pcn/MA-pcn_npu_20210610173506-06-17-15-30/code/
[Modelarts Service Log]boot_file: code/train.py
[Modelarts Service Log]log_url: /tmp/log/MA-pcn_npu_20210610173506-06-17-15-30.log
[Modelarts Service Log]command: code/train.py --data_url=s3://pcn/pcn_dataset/pcn/ --train_url=s3://pcn/MA-pcn_npu_20210610173506-06-17-15-30/output/V0004/
[Modelarts Service Log]local_code_dir: 
[Modelarts Service Log]Training start at 2021-06-17-15:46:14
[Modelarts Service Log][modelarts_create_log] modelarts-pipe found
[ModelArts Service Log]modelarts-pipe: will create log file /tmp/log/MA-pcn_npu_20210610173506-06-17-15-30.log
[Modelarts Service Log]handle inputs of training job
INFO:root:Using MoXing-v1.17.3-8aa951bc
INFO:root:Using OBS-Python-SDK-3.20.7
[ModelArts Service Log][INFO][2021/06/17 15:46:15]: env MA_INPUTS is not found, skip the inputs handler
INFO:root:Using MoXing-v1.17.3-8aa951bc
INFO:root:Using OBS-Python-SDK-3.20.7
[ModelArts Service Log]2021-06-17 15:46:16,203 - modelarts-downloader.py[line:620] - INFO: Main: modelarts-downloader starting with Namespace(dst='./', recursive=True, skip_creating_dir=False, src='s3://pcn/MA-pcn_npu_20210610173506-06-17-15-30/code/', trace=False, type='common', verbose=False)
[Modelarts Service Log][modelarts_logger] modelarts-pipe found
[ModelArts Service Log]modelarts-pipe: will create log file /tmp/log/MA-pcn_npu_20210610173506-06-17-15-30.log
[ModelArts Service Log]modelarts-pipe: will write log file /tmp/log/MA-pcn_npu_20210610173506-06-17-15-30.log
[ModelArts Service Log]modelarts-pipe: param for max log length: 1073741824
[ModelArts Service Log]modelarts-pipe: param for whether exit on overflow: 0
[ModelArts Service Log]modelarts-pipe: total length: 24
/home/work/user-job-dir
[Modelarts Service Log][modelarts_logger] modelarts-pipe found
[ModelArts Service Log]modelarts-pipe: will create log file /tmp/log/MA-pcn_npu_20210610173506-06-17-15-30.log
[ModelArts Service Log]modelarts-pipe: will write log file /tmp/log/MA-pcn_npu_20210610173506-06-17-15-30.log
[ModelArts Service Log]modelarts-pipe: param for max log length: 1073741824
[ModelArts Service Log]modelarts-pipe: param for whether exit on overflow: 0
INFO:root:Using MoXing-v1.17.3-8aa951bc
INFO:root:Using OBS-Python-SDK-3.20.7
[Modelarts Service Log]2021-06-17 15:46:17,829 - WARNING - stdout log /var/log/batch-task/job2e513b17/job-ma-pcn-npu-202106101/stdout.log is not found
[Modelarts Service Log]2021-06-17 15:46:17,837 - INFO - Ascend Driver: Version=20.2.0
[Modelarts Service Log]2021-06-17 15:46:17,838 - INFO - ['/usr/bin/python', '/home/work/user-job-dir/code/train.py', '--data_url=s3://pcn/pcn_dataset/pcn/', '--train_url=s3://pcn/MA-pcn_npu_20210610173506-06-17-15-30/output/V0004/']
[Modelarts Service Log]2021-06-17 15:46:17,838 - INFO - Wait for Rank table file ready
[Modelarts Service Log]2021-06-17 15:46:17,838 - INFO - Rank table file (K8S generated) is ready for read
[Modelarts Service Log]2021-06-17 15:46:17,839 - INFO - 
{
    "status": "completed",
    "group_count": "1",
    "group_list": [
        {
            "group_name": "job-ma-pcn-npu-202106101",
            "device_count": "1",
            "instance_count": "1",
            "instance_list": [
                {
                    "pod_name": "job2e513b17-job-ma-pcn-npu-202106101-0",
                    "server_id": "192.168.0.231",
                    "devices": [
                        {
                            "device_id": "1",
                            "device_ip": "192.2.208.175"
                        }
                    ]
                }
            ]
        }
    ]
}
[Modelarts Service Log]2021-06-17 15:46:17,839 - INFO - Rank table file (C7x)
[Modelarts Service Log]2021-06-17 15:46:17,839 - INFO - 
{
    "status": "completed",
    "version": "1.0",
    "server_count": "1",
    "server_list": [
        {
            "server_id": "192.168.0.231",
            "device": [
                {
                    "device_id": "1",
                    "device_ip": "192.2.208.175",
                    "rank_id": "0"
                }
            ]
        }
    ]
}
[Modelarts Service Log]2021-06-17 15:46:17,839 - INFO - Rank table file (C7x) is generated
[Modelarts Service Log]2021-06-17 15:46:17,840 - INFO - Current server
[Modelarts Service Log]2021-06-17 15:46:17,840 - INFO - 
{
    "server_id": "192.168.0.231",
    "device": [
        {
            "device_id": "1",
            "device_ip": "192.2.208.175",
            "rank_id": "0"
        }
    ]
}
[Modelarts Service Log]2021-06-17 15:46:17,841 - INFO - bootstrap proc-rank-0-device-0
[Modelarts Service Log]2021-06-17 15:46:17,849 - INFO - proc-rank-0-device-0 (pid: 115)
  Would remove:
    /usr/local/ma/python3.7/lib/python3.7/site-packages/enum/*
    /usr/local/ma/python3.7/lib/python3.7/site-packages/enum34-1.1.10.dist-info/*
Proceed (y/n)? ERROR: Exception:
Traceback (most recent call last):
  File "/usr/local/ma/python3.7/lib/python3.7/site-packages/pip/_internal/cli/base_command.py", line 188, in main
    status = self.run(options, args)
  File "/usr/local/ma/python3.7/lib/python3.7/site-packages/pip/_internal/commands/uninstall.py", line 75, in run
    auto_confirm=options.yes, verbose=self.verbosity > 0,
  File "/usr/local/ma/python3.7/lib/python3.7/site-packages/pip/_internal/req/req_install.py", line 831, in uninstall
    uninstalled_pathset.remove(auto_confirm, verbose)
  File "/usr/local/ma/python3.7/lib/python3.7/site-packages/pip/_internal/req/req_uninstall.py", line 382, in remove
    if auto_confirm or self._allowed_to_proceed(verbose):
  File "/usr/local/ma/python3.7/lib/python3.7/site-packages/pip/_internal/req/req_uninstall.py", line 425, in _allowed_to_proceed
    return ask('Proceed (y/n)? ', ('y', 'n')) == 'y'
  File "/usr/local/ma/python3.7/lib/python3.7/site-packages/pip/_internal/utils/misc.py", line 266, in ask
    response = input(message)
EOFError: EOF when reading a line
Looking in indexes: http://repo.myhuaweicloud.com/repository/pypi/simple
Collecting tensorpack
  Downloading http://repo.myhuaweicloud.com/repository/pypi/packages/f9/8c/63e5f5a4a04dea36b75850f9daa885ccbfad64bec1fae0ee4ca9f31b3eaa/tensorpack-0.11-py2.py3-none-any.whl (296kB)
Requirement already satisfied: psutil>=5 in /usr/local/ma/python3.7/lib/python3.7/site-packages (from tensorpack) (5.7.0)
Requirement already satisfied: numpy>=1.14 in /usr/local/ma/python3.7/lib/python3.7/site-packages (from tensorpack) (1.17.5)
Collecting tabulate>=0.7.7 (from tensorpack)
  Downloading http://repo.myhuaweicloud.com/repository/pypi/packages/ca/80/7c0cad11bd99985cfe7c09427ee0b4f9bd6b048bd13d4ffb32c6db237dfb/tabulate-0.8.9-py3-none-any.whl
Collecting pyzmq>=16 (from tensorpack)
  Downloading http://repo.myhuaweicloud.com/repository/pypi/packages/a3/7a/561526861908d366ddc2764933a6090078654b0f2ff20c3c180dd5851554/pyzmq-22.0.3.tar.gz (1.2MB)
  Installing build dependencies: started
  Installing build dependencies: finished with status 'error'
  ERROR: Command errored out with exit status 1:
   command: /usr/local/ma/python3.7/bin/python3.7 /usr/local/ma/python3.7/lib/python3.7/site-packages/pip install --ignore-installed --no-user --prefix /tmp/pip-build-env-u2qowvmx/overlay --no-warn-script-location --no-binary :none: --only-binary :none: -i http://repo.myhuaweicloud.com/repository/pypi/simple --trusted-host repo.myhuaweicloud.com -- 'setuptools>=40.8.0' wheel
       cwd: None
  Complete output (14 lines):
  Traceback (most recent call last):
    File "/usr/local/ma/python3.7/lib/python3.7/runpy.py", line 193, in _run_module_as_main
      "__main__", mod_spec)
    File "/usr/local/ma/python3.7/lib/python3.7/runpy.py", line 85, in _run_code
      exec(code, run_globals)
    File "/usr/local/ma/python3.7/lib/python3.7/site-packages/pip/__main__.py", line 16, in <module>
      from pip._internal import main as _main  # isort:skip # noqa
    File "/usr/local/ma/python3.7/lib/python3.7/site-packages/pip/_internal/__init__.py", line 4, in <module>
      import locale
    File "/usr/local/ma/python3.7/lib/python3.7/locale.py", line 16, in <module>
      import re
    File "/usr/local/ma/python3.7/lib/python3.7/re.py", line 143, in <module>
      class RegexFlag(enum.IntFlag):
  AttributeError: module 'enum' has no attribute 'IntFlag'
  ----------------------------------------
ERROR: Command errored out with exit status 1: /usr/local/ma/python3.7/bin/python3.7 /usr/local/ma/python3.7/lib/python3.7/site-packages/pip install --ignore-installed --no-user --prefix /tmp/pip-build-env-u2qowvmx/overlay --no-warn-script-location --no-binary :none: --only-binary :none: -i http://repo.myhuaweicloud.com/repository/pypi/simple --trusted-host repo.myhuaweicloud.com -- 'setuptools>=40.8.0' wheel Check the logs for full command output.
WARNING:tensorflow:From /usr/local/Ascend/tfplugin/latest/tfplugin/python/site-packages/npu_bridge/estimator/npu/npu_optimizer.py:225: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.
Traceback (most recent call last):
  File "/home/work/user-job-dir/code/train.py", line 35, in <module>
    from data_util import lmdb_dataflow, get_queued_data
  File "/cache/user-job-dir/code/data_util.py", line 29, in <module>
    from tensorpack import dataflow
ModuleNotFoundError: No module named 'tensorpack'
[Modelarts Service Log]2021-06-17 15:46:27,865 - ERROR - proc-rank-0-device-0 (pid: 115) has exited with non-zero code: 1
[Modelarts Service Log]2021-06-17 15:46:27,865 - INFO - Begin destroy training processes
[Modelarts Service Log]2021-06-17 15:46:27,865 - INFO - proc-rank-0-device-0 (pid: 115) has exited
[Modelarts Service Log]2021-06-17 15:46:27,866 - INFO - End destroy training processes
[ModelArts Service Log]modelarts-pipe: total length: 7973
[Modelarts Service Log]Training end with return code: 1
[Modelarts Service Log]upload ascend-log to s3://pcn/MA-pcn_npu_20210610173506-06-17-15-30/log/ascend-log/ at 2021-06-17-15:46:27
upload_tail_log.py -l 2048 -o s3://pcn/MA-pcn_npu_20210610173506-06-17-15-30/log/ascend-log/
[Modelarts Service Log]upload ascend-log end at 2021-06-17-15:46:28
[Modelarts Service Log]Training end at 2021-06-17-15:46:28
[Modelarts Service Log]Training completed.
